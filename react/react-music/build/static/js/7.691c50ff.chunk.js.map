{"version":3,"sources":["application/Singers/style.js","baseUI/music-note/index.js","baseUI/header/index.js","application/SongsList/style.js","application/SongsList/index.js","application/Singer/style.js","application/Singer/index.js"],"names":["NavContainer","styled","div","ListContainer","props","play","List","style","ListItem","EnterLoading","Container","MusicNote","forwardRef","ref","iconsRef","useRef","transform","prefixStyle","createNode","txt","template","tempNode","document","createElement","innerHTML","firstChild","useEffect","i","node","current","appendChild","slice","call","children","forEach","item","running","addEventListener","this","querySelector","startAnimation","x","y","left","top","display","setTimeout","useImperativeHandle","React","memo","HeaderContainer","Header","handleClick","title","isMarquee","className","onClick","defaultProps","SongList","showBackground","SongItem","ul","noWrap","SongsList","refs","useState","startIndex","setStartIndex","songs","collectCount","showCollect","loading","usePageSplit","musicAnimation","changePlayListDispatch","changeCurrentIndexDispatch","changeSequecePlayListDispatch","totalCount","length","ONE_PAGE_COUNT","count","selectItem","e","index","nativeEvent","clientX","clientY","Math","floor","list","res","end","push","key","id","name","ar","getName","artists","al","album","songList","connect","state","fullScreen","getIn","playing","currentSong","scrollY","dispatch","data","changePlayList","changeCurrentIndex","changeSequecePlayList","ImgWrapper","bgUrl","CollectButton","SongListWrapper","BgLayer","artist","songsCount","size","getSingerDataDispatch","changeEnterLoading","getSingerInfo","initialHeight","showStatus","setShowStatus","immutableArtist","immutableSongs","toJS","collectButton","imageWrapper","songScrollWrapper","songScroll","header","layer","musicNoteRef","match","params","h","offsetHeight","refresh","setShowStatusFalse","useCallback","CSSTransition","in","timeout","classNames","appear","unmountOnExit","onExited","history","goBack","picUrl","onScroll","pos","height","newY","imageDOM","buttonDOM","headerDOM","layerDOM","minScrollY","HEADER_HEIGHT","percent","abs","zIndex","paddingTop"],"mappings":"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","file":"static/js/7.691c50ff.chunk.js","sourcesContent":["import styled from 'styled-components';\r\nimport style from '../../assets/global-style';\r\n\r\nexport const NavContainer  = styled.div`\r\n  box-sizing: border-box;\r\n  position: fixed;\r\n  top: 95px;\r\n  width: 100%;\r\n  padding: 5px;\r\n  overflow: hidden;\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\nexport const ListContainer = styled.div`\r\n  position: fixed;\r\n  top: 160px;\r\n  left: 0;\r\n  bottom: ${props => props.play ? \"60px\": 0};\r\n  overflow: hidden;\r\n  width: 100%;\r\n`;\r\n\r\nexport const List = styled.div`\r\n  display: flex;\r\n  margin: auto;\r\n  flex-direction: column;\r\n  overflow: hidden;\r\n  .title {\r\n    margin:10px 0 10px 10px;\r\n    color: ${style[\"font-color-desc\"]};\r\n    font-size: ${style[\"font-size-s\"]};\r\n  }\r\n`;\r\nexport const ListItem = styled.div`\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: 0 5px;\r\n  padding: 5px 0;\r\n  align-items: center;\r\n  border-bottom: 1px solid ${style[\"border-color\"]};\r\n  .img_wrapper {\r\n    margin-right: 20px;\r\n    img{\r\n      border-radius: 3px;\r\n      width: 50px;\r\n      height: 50px;\r\n    }\r\n  }\r\n  .name{\r\n    font-size: ${style[\"font-size-m\"]};\r\n    color: ${style[\"font-color-desc\"]};\r\n    font-weight: 500;\r\n  }\r\n`;\r\nexport const EnterLoading = styled.div`\r\n  position: fixed;\r\n  left: 0; right: 0; top: 0; bottom: 0;\r\n  width: 100px;\r\n  height: 100px;\r\n  margin: auto;\r\n`\r\n","import React, {useEffect, useImperativeHandle, useRef, forwardRef} from 'react';\nimport styled from 'styled-components';\nimport { prefixStyle } from '../../api/utils';\nimport style from '../../assets/global-style';\n\nconst Container = styled.div`\n  .icon_wrapper{\n    position: fixed;\n    z-index: 1000;\n    margin-top: -10px;\n    margin-left: -10px;\n    color: ${style[\"theme-color\"]};\n    font-size: 14px;\n    display: none;\n    transition: transform 1s cubic-bezier(.62,-0.1,.86,.57);\n    transform: translate3d(0, 0, 0);\n    >div{\n      transition: transform 1s;\n    }\n  }\n`\n\nconst MusicNote = forwardRef((props, ref) => {\n\n  const iconsRef = useRef();\n\n  const ICON_NUMBER = 10;\n\n  const transform = prefixStyle(\"transform\");\n\n  const createNode = (txt) => {\n    const template = `<div class='icon_wrapper'>${txt}</div>`;\n    let tempNode = document.createElement('div');\n    tempNode.innerHTML = template;\n    return tempNode.firstChild;\n  }\n\n  useEffect(() => {\n    for(let i = 0; i < ICON_NUMBER; i++){\n      let node = createNode(`<div class=\"iconfont\">&#xe642;</div>`);\n      iconsRef.current.appendChild(node);\n    }\n    let domArray = [].slice.call(iconsRef.current.children)\n    domArray.forEach(item => {\n      item.running = false;\n      item.addEventListener('transitionend', function() {\n        this.style['display'] = 'none';\n        this.style[transform] = `translate3d(0, 0, 0)`;\n        this.running = false;\n\n        let icon = this.querySelector('div');\n        icon.style[transform] = `translate3d(0, 0, 0)`;\n      }, false);\n    });\n    // eslint-disable-next-line\n  }, []);\n\n  const startAnimation = ({x, y}) => {\n    for(let i = 0; i < ICON_NUMBER; i++) {\n      let domArray = [].slice.call(iconsRef.current.children)\n      let item = domArray[i]\n      // 选择一个空闲的元素来开始动画\n      if (item.running === false) {\n        item.style.left = x + \"px\";\n        item.style.top = y + \"px\";\n        item.style.display = \"inline-block\";\n        setTimeout(() => {\n          item.running = true;\n          item.style[transform] = `translate3d(0, 750px, 0)`;\n          let icon = item.querySelector(\"div\");\n          icon.style[transform] = `translate3d(-40px, 0, 0)`;\n        }, 20);\n        break;\n      }\n    }\n  };\n  \n  //外界调用的ref方法\n  useImperativeHandle(ref, () => ({\n    startAnimation\n  }));\n\n  return (\n    <Container ref={iconsRef}>\n    </Container>\n  )\n})\n\nexport default React.memo(MusicNote);","import React from 'react';\nimport styled from'styled-components';\nimport style from '../../assets/global-style';\nimport PropTypes from \"prop-types\";\n\nconst HeaderContainer = styled.div`\n  position: fixed;\n  padding: 5px 10px;\n  padding-top: 0;\n  height: 40px;\n  width: 100%;\n  z-index: 100;\n  display: flex;\n  line-height: 40px;\n  color: ${style [\"font-color-light\"]};\n  .back {\n    margin-right: 5px;\n    font-size: 20px;\n    width: 20px;\n  }\n  >h1 {\n    font-size: ${style [\"font-size-l\"]};\n    font-weight: 700;\n  }\n`\n// 处理函数组件拿不到 ref 的问题，所以用 forwardRef\nconst Header =  React.forwardRef ((props, ref) => {\n  const { handleClick, title, isMarquee} = props;\n  return (\n    <HeaderContainer ref={ref}>\n      <i className=\"iconfont back\"  onClick={handleClick}>&#xe655;</i>\n      {\n        isMarquee ? <marquee><h1>{title}</h1></marquee>:\n        <h1>{title}</h1>\n      }\n    </HeaderContainer>\n  )\n})\n\nHeader.defaultProps = {\n  handleClick: () => {},\n  title: \"标题\",\n  isMarquee: false\n};\n\nHeader.propTypes = {\n  handleClick: PropTypes.func,\n  title: PropTypes.string,\n  isMarquee: PropTypes.bool\n};\n\nexport default React.memo (Header);","import styled from 'styled-components';\nimport style from '../../assets/global-style';\n\nexport const SongList = styled.div`\n  border-radius: 10px;\n  opacity: 0.98;\n  ${props => props.showBackground ? `background: ${style[\"highlight-background-color\"]}`: \"\"};\n  .first_line{\n    box-sizing: border-box;\n    padding: 10px 0;\n    margin-left: 10px;\n    position: relative;\n    justify-content: space-between;\n    border-bottom: 1px solid ${style[\"border-color\"]};\n    .play_all{\n      display: inline-block;\n      line-height: 24px;\n      color: ${style[\"font-color-desc\"]};\n      .iconfont {\n        font-size: 24px;\n        margin-right: 10px;\n        vertical-align: top;\n      }\n      .sum{\n        font-size: ${style[\"font-size-s\"]};\n        color: ${style[\"font-color-desc-v2\"]};\n      }\n      >span{\n        vertical-align: top;\n      }\n    }\n    .add_list,.isCollected {\n      display: flex;\n      align-items: center;\n      position: absolute;\n      right: 0; top :0; bottom: 0;\n      width: 130px;\n      line-height: 34px;\n      background: ${style[\"theme-color\"]};\n      color: ${style[\"font-color-light\"]};\n      font-size: 0;\n      border-radius: 3px;\n      vertical-align: top;\n      .iconfont {\n        vertical-align: top;\n        font-size: 10px;\n        margin: 0 5px 0 10px;\n      }\n      span{\n        font-size: 14px;\n        line-height: 34px;\n      }\n    }\n    .isCollected{\n      display: flex;\n      background: ${style[\"background-color\"]};\n      color: ${style[\"font-color-desc\"]};\n    }\n}\n`\nexport const SongItem = styled.ul`\n  >li{\n    display: flex;\n    height: 60px;\n    align-items: center;  \n    .index{\n      flex-basis: 60px;\n      width: 60px;\n      height: 60px;\n      line-height: 60px;\n      text-align: center;\n    }\n    .info{\n      box-sizing: border-box;\n      flex: 1;\n      display: flex;\n      height: 100%;\n      padding: 5px 0;\n      flex-direction: column;\n      justify-content: space-around;\n      border-bottom: 1px solid ${style[\"border-color\"]};\n      ${style.noWrap()}\n      >span{\n        ${style.noWrap()}\n      }\n      >span:first-child{\n        color: ${style[\"font-color-desc\"]};\n      }\n      >span:last-child{\n        font-size: ${style[\"font-size-s\"]};\n        color: #bba8a8;\n      }\n    }\n  }\n`","import React, {useState, useEffect } from 'react';\nimport { SongList, SongItem } from \"./style\";\nimport { getName } from '../../api/utils';\nimport { ONE_PAGE_COUNT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from './../../application/Player/store/actionCreators';\n\nconst SongsList = React.forwardRef((props, refs)=> {\n\n  const [startIndex, setStartIndex] = useState(0);\n\n  const { songs, collectCount, showCollect,loading=false, usePageSplit } = props;\n\n  const { musicAnimation } = props;\n\n  const { changePlayListDispatch, changeCurrentIndexDispatch, changeSequecePlayListDispatch } = props;\n  const totalCount = songs.length;\n\n  useEffect(() => {\n    if(!loading) return;\n    if(startIndex + 1 + ONE_PAGE_COUNT >= totalCount)\n      return;\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\n  }, [loading, startIndex, totalCount]);\n\n  const selectItem = (e, index) => {\n    changePlayListDispatch(songs);\n    changeSequecePlayListDispatch(songs);\n    changeCurrentIndexDispatch(index);\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\n  }\n\n  let songList = (list) => {\n    let res = [];\n    // 判断页数是否超过总数\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\n    for(let i = 0; i < end; i++) {\n      if(i >= list.length) break;\n      let item = list[i];\n      res.push(\n        <li key={item.id} onClick={(e) => selectItem(e, i)}>\n          <span className=\"index\">{i + 1}</span>\n          <div className=\"info\">\n            <span>{item.name}</span>\n            <span>\n              { item.ar ? getName(item.ar): getName(item.artists) } - { item.al ? item.al.name : item.album.name}\n            </span>\n          </div>\n        </li>\n      )\n    }\n    return res;\n  };\n\n  const collect = (count) => {\n    return  (\n      <div className=\"add_list\">\n        <i className=\"iconfont\">&#xe62d;</i>\n        <span>收藏({Math.floor(count/1000)/10}万)</span>\n      </div>\n      // <div className=\"isCollected\">\n      //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\n      // </div>\n    )\n  };\n  return (\n    <SongList ref={refs} showBackground={props.showBackground}>\n      <div className=\"first_line\">\n        <div className=\"play_all\" onClick={(e) => selectItem(e, 0)}>\n          <i className=\"iconfont\">&#xe6e3;</i>\n          <span>播放全部 <span className=\"sum\">(共{totalCount}首)</span></span>\n        </div>\n        { showCollect ? collect(collectCount) : null}\n      </div>\n      <SongItem>\n        { songList(songs) }\n      </SongItem>\n    </SongList>\n  )\n});\n\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = (state) => ({\n  fullScreen: state.getIn(['player', 'fullScreen']),\n  playing: state.getIn(['player', 'playing']),\n  currentSong: state.getIn(['player', 'currentSong']),\n  scrollY: state.getIn(['album', 'scrollY'])  \n});\n// 映射dispatch到props上\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    changePlayListDispatch(data){\n      dispatch(changePlayList(data));\n    },\n    changeCurrentIndexDispatch(data) {\n      dispatch(changeCurrentIndex(data));\n    },\n    changeSequecePlayListDispatch(data) {\n      dispatch(changeSequecePlayList(data))\n    }\n  }\n};\n\n\n// 将ui组件包装成容器组件\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(SongsList));","import styled from 'styled-components';\nimport style from '../../assets/global-style';\n\nexport const Container = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: ${props => props.play > 0 ? \"60px\": 0};\n  width: 100%;\n  z-index: 100;\n  overflow: hidden;\n  background: #f2f3f4;\n  transform-origin: right bottom;\n  &.fly-enter, &.fly-appear{\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n  &.fly-enter-active, &.fly-appear-active{\n    transition: transform .3s;\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit{\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit-active{\n    transition: transform .3s;\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n`\n\nexport const ImgWrapper = styled.div`\n  position: relative;\n  width: 100%;\n  height: 0;\n  padding-top: 75%;\n  transform-origin: top;\n  background: url(${props => props.bgUrl});\n  background-size: cover;\n  z-index: 50;\n  .filter {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    /* : blur(20px); */\n    background: rgba(7, 17, 27, 0.3);\n  }\n`\nexport const CollectButton = styled.div`\n  position: fixed;\n  left: 0; right: 0;\n  margin: auto;\n  box-sizing: border-box;\n  width: 120px;\n  height: 40px;\n  margin-top: -55px;\n  z-index:50;\n  background: ${style[\"theme-color\"]};\n  color: ${style[\"font-color-light\"]};\n  border-radius: 20px;\n  text-align: center;\n  font-size: 0;\n  line-height: 40px;\n  .iconfont{\n    display: inline-block;\n    margin-right: 10px;\n    font-size: 12px;\n    vertical-align: 1px;\n  }\n  .text {\n    display: inline-block;\n    font-size:14px;\n    letter-spacing: 5px;\n  }\n`\n\nexport const SongListWrapper = styled.div`\n  position: absolute;\n  z-index: 50;\n  top: 0;\n  left: 0;\n  bottom: ${props => props.play ? \"60px\": 0};\n  right: 0;\n  >div{\n    position: absolute;\n    left: 0;\n    width: 100%;\n    overflow: visible;\n  }\n`\nexport const BgLayer = styled.div`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  width: 100%;\n  background: white;\n  border-radius: 10px;\n  z-index: 50;\n`","  \nimport React, { useState, useEffect, useRef, useCallback } from \"react\";\nimport { Container } from \"./style\";\nimport Header from \"../../baseUI/header/index\";\nimport { ImgWrapper, CollectButton, SongListWrapper, BgLayer } from \"./style\";\nimport Scroll from \"../../baseUI/scroll/index\";\nimport { HEADER_HEIGHT } from \"./../../api/config\";\nimport { getSingerInfo } from \"./store/actionCreators\";\nimport { connect } from \"react-redux\";\nimport Loading from \"./../../baseUI/loading/index\";\nimport { EnterLoading } from \"../Singers/style\";\nimport { changeEnterLoading } from \"./store/actionCreators\";\nimport { CSSTransition } from \"react-transition-group\";\nimport SongsList from \"../SongsList/\";\nimport MusicNote from \"../../baseUI/music-note/index\";\n\nfunction Singer(props) {\n  const initialHeight = useRef(0);\n  const [showStatus, setShowStatus] = useState(true);\n\n  const OFFSET = 5;\n\n  const { \n    artist: immutableArtist, \n    songs: immutableSongs, \n    loading,\n    songsCount\n  } = props;\n\n  const { getSingerDataDispatch } = props;\n\n  const artist = immutableArtist.toJS();\n  const songs = immutableSongs.toJS();\n\n  const collectButton = useRef();\n  const imageWrapper = useRef();\n  const songScrollWrapper = useRef();\n  const songScroll = useRef();\n  const header = useRef();\n  const layer = useRef();\n  const musicNoteRef = useRef();\n\n  useEffect(() => {\n    const id = props.match.params.id;\n    getSingerDataDispatch(id);\n    let h = imageWrapper.current.offsetHeight;\n    initialHeight.current = h;\n    songScrollWrapper.current.style.top = `${h - OFFSET}px`;\n    //把遮罩先放在下面，以裹住歌曲列表\n    layer.current.style.top = `${h - OFFSET}px`;\n    songScroll.current.refresh();\n    // eslint-disable-next-line\n  }, []);\n\n  const handleScroll = pos => {\n    let height = initialHeight.current;\n    const newY = pos.y;\n    const imageDOM = imageWrapper.current;\n    const buttonDOM = collectButton.current;\n    const headerDOM = header.current;\n    const layerDOM = layer.current;\n    const minScrollY = -(height - OFFSET) + HEADER_HEIGHT;\n\n    const percent = Math.abs(newY / height);\n    //说明: 在歌手页的布局中，歌单列表其实是没有自己的背景的，layerDOM其实是起一个遮罩的作用，给歌单内容提供白色背景\n    //因此在处理的过程中，随着内容的滚动，遮罩也跟着移动\n    if (newY > 0) {\n      //处理往下拉的情况,效果：图片放大，按钮跟着偏移\n      imageDOM.style[\"transform\"] = `scale(${1 + percent})`;\n      buttonDOM.style[\"transform\"] = `translate3d(0, ${newY}px, 0)`;\n      layerDOM.style.top = `${height - OFFSET + newY}px`;\n    } else if (newY >= minScrollY) {\n      //往上滑动，但是还没超过Header部分\n      layerDOM.style.top = `${height - OFFSET - Math.abs(newY)}px`;\n      layerDOM.style.zIndex = 1;\n      imageDOM.style.paddingTop = \"75%\";\n      imageDOM.style.height = 0;\n      imageDOM.style.zIndex = -1;\n      buttonDOM.style[\"transform\"] = `translate3d(0, ${newY}px, 0)`;\n      buttonDOM.style[\"opacity\"] = `${1 - percent * 2}`;\n    } else if (newY < minScrollY) {\n      //往上滑动，但是超过Header部分\n      layerDOM.style.top = `${HEADER_HEIGHT - OFFSET}px`;\n      layerDOM.style.zIndex = 1;\n      //防止溢出的歌单内容遮住Header\n      headerDOM.style.zIndex = 100;\n      //此时图片高度与Header一致\n      imageDOM.style.height = `${HEADER_HEIGHT}px`;\n      imageDOM.style.paddingTop = 0;\n      imageDOM.style.zIndex = 99;\n    }\n  };\n\n  const musicAnimation = (x, y) => {\n    musicNoteRef.current.startAnimation({ x, y });\n  };\n\n  const setShowStatusFalse = useCallback(() => {\n    setShowStatus(false);\n  }, [])\n\n  return (\n    <CSSTransition\n      in={showStatus}\n      timeout={300}\n      classNames=\"fly\"\n      appear={true}\n      unmountOnExit\n      onExited={() => props.history.goBack()}\n    >\n      <Container>\n        <Header\n          handleClick={setShowStatusFalse}\n          title={artist.name}\n          ref={header}\n        ></Header>\n        <ImgWrapper ref={imageWrapper} bgUrl={artist.picUrl}>\n          <div className=\"filter\"></div>\n        </ImgWrapper>\n        <CollectButton ref={collectButton}>\n          <i className=\"iconfont\">&#xe62d;</i>\n          <span className=\"text\">收藏</span>\n        </CollectButton>\n        <BgLayer ref={layer}></BgLayer>\n        <SongListWrapper ref={songScrollWrapper} play={songsCount}>\n          <Scroll onScroll={handleScroll} ref={songScroll}>\n            <SongsList\n              songs={songs}\n              showCollect={false}\n              usePageSplit={false}\n              musicAnimation={musicAnimation}\n            ></SongsList>\n          </Scroll>\n        </SongListWrapper>\n        {loading ? (\n          <EnterLoading style={{ zIndex: 100 }}>\n            <Loading></Loading>\n          </EnterLoading>\n        ) : null}\n        <MusicNote ref={musicNoteRef}></MusicNote>\n      </Container>\n    </CSSTransition>\n  );\n}\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = state => ({\n  artist: state.getIn([\"singerInfo\", \"artist\"]),\n  songs: state.getIn([\"singerInfo\", \"songsOfArtist\"]),\n  loading: state.getIn([\"singerInfo\", \"loading\"]),\n  songsCount: state.getIn([\"player\", \"playList\"]).size\n});\n// 映射dispatch到props上\nconst mapDispatchToProps = dispatch => {\n  return {\n    getSingerDataDispatch(id) {\n      dispatch(changeEnterLoading(true));\n      dispatch(getSingerInfo(id));\n    }\n  };\n};\n\n// 将ui组件包装成容器组件\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(React.memo(Singer));\n"],"sourceRoot":""}
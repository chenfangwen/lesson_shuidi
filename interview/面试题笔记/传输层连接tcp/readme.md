## Tcp的链接建立（三次握手）

1.    服务端进程先创建传输控制块（TCB），准备接受客户端进程的连接请求，服务端处于listen的状态，等待客户端的连接请求；
2.    客户端继承创建传输控制块（TCB），然后向服务端发送请求报文段，这是首部的同步位SYN=1，同时选择一个序列号seq = x.(TCP规定，SYN报文段不能携带任何数据，但是要消耗一个序号)，这时客户端进程进入SYN-SENT（同步已发送）状态；
3.    服务端收到客户端的请求报文后，如同意建立连接，则向客户端发送确认。在确认报文中应把SYN和ACK都置为1，确认号是ack=x+1,同时也为自己选择一个初始的序号seq=y,这个确认报文也不能携带数据，但是要消耗一个序号,这时TCP服务端进程进入SYN-RCVD（同步已收到状态）状态。
4.    客户端收到服务端的确认后，还要向服务端进行确认。确认报文段的ACK为1，确认好为ack = y+1,自己的序号为seq = x+1,ACK报文段可以携带数据，但是如果不携带数据则不消耗序号，此时TCP连接已经建立，客户端进入ESTABLISHED状态（已建立连接状态）；
5.    服务端收到确认后也进入以建立连接状态。

## Tcp的连接释放（四次握手）

1.    当不再需要传输数据时，客户端会向服务端发送释放报文段，将连接释放报文段的FIN置为1，其序号为seq = u,这时客户端进入终止等待1状态；（TCP规定，FIN报文段即使不携带数据，也消耗掉一个序号）
2.    服务端收到释放报文段后发送确认，确认号为ack=u+1,这个报文段自己的序号为w,然后服务端进入关闭等待状态（这时TCP服务器进程就会通知应用进程，因而从客户端到服务器的连接就是放了），这时TCP处于半关闭状态 
3.    当客户端收到来自服务器端的确认后就会进入终止等待2状态，等待服务器发出的连接释放报文；
4.    服务端发出连接释放报文段，使得FIN=1，服务器必须重复上次已发送的确认号ack=u+1,这时服务器进入最后的确认状态，等待客户端的确认；
5.    客户端在收到服务端的释放报文段后，必须对此发出确认。在确认报文段中报ACK置为1，确认号为ack = w+1,自己的序号变成seq = u+1,进入时间等待状态。

TCP 和 UDP 的区别
TCP 是面向连接的，        UDP 是面向无连接的
TCP 头部20字节           UDP 头部8字节
TCP 是面向字节流的，      UDP 是基于数据报的
TCP 保证数据正确性，可靠， UDP不降低传输速率， 可能丢包
TCP 保证数据顺序，        UDP 不保证

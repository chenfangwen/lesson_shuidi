{"version":3,"sources":["baseUI/music-note/index.js","application/Album/style.js","baseUI/header/index.js","application/SongsList/style.js","application/SongsList/index.js","application/Album/index.js"],"names":["Container","styled","div","style","MusicNote","forwardRef","props","ref","iconsRef","useRef","transform","prefixStyle","createNode","txt","template","tempNode","document","createElement","innerHTML","firstChild","useEffect","i","node","current","appendChild","slice","call","children","forEach","item","running","addEventListener","this","querySelector","startAnimation","x","y","left","top","display","setTimeout","useImperativeHandle","React","memo","TopDesc","background","Menu","SongItem","ul","noWrap","HeaderContainer","Header","handleClick","title","isMarquee","className","onClick","defaultProps","SongList","showBackground","SongsList","refs","useState","startIndex","setStartIndex","songs","collectCount","showCollect","loading","usePageSplit","musicAnimation","changePlayListDispatch","changeCurrentIndexDispatch","changeSequecePlayListDispatch","totalCount","length","ONE_PAGE_COUNT","count","selectItem","e","index","nativeEvent","clientX","clientY","Math","floor","list","res","end","push","key","id","name","ar","getName","artists","al","album","songList","connect","state","fullScreen","getIn","playing","currentSong","scrollY","dispatch","data","changePlayList","changeCurrentIndex","changeSequecePlayList","currentAlbum","enterLoading","songsCount","size","getAlbumDataDispatch","changeEnterLoading","getAlbumList","showStatus","setShowStatus","setTitle","setIsMarquee","headerEl","musicNoteRef","currentAlbumImmutable","match","params","toJS","handleBack","useCallback","handleScroll","pos","minScrollY","HEADER_HEIGHT","percent","abs","headerDom","backgroundColor","opacity","min","in","timeout","classNames","appear","unmountOnExit","onExited","history","goBack","play","isEmptyObject","bounceTop","onScroll","coverImgUrl","src","alt","getCount","subscribedCount","creator","avatarUrl","nickname","tracks"],"mappings":"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","file":"static/js/6.df817a21.chunk.js","sourcesContent":["import React, {useEffect, useImperativeHandle, useRef, forwardRef} from 'react';\nimport styled from 'styled-components';\nimport { prefixStyle } from '../../api/utils';\nimport style from '../../assets/global-style';\n\nconst Container = styled.div`\n  .icon_wrapper{\n    position: fixed;\n    z-index: 1000;\n    margin-top: -10px;\n    margin-left: -10px;\n    color: ${style[\"theme-color\"]};\n    font-size: 14px;\n    display: none;\n    transition: transform 1s cubic-bezier(.62,-0.1,.86,.57);\n    transform: translate3d(0, 0, 0);\n    >div{\n      transition: transform 1s;\n    }\n  }\n`\n\nconst MusicNote = forwardRef((props, ref) => {\n\n  const iconsRef = useRef();\n\n  const ICON_NUMBER = 10;\n\n  const transform = prefixStyle(\"transform\");\n\n  const createNode = (txt) => {\n    const template = `<div class='icon_wrapper'>${txt}</div>`;\n    let tempNode = document.createElement('div');\n    tempNode.innerHTML = template;\n    return tempNode.firstChild;\n  }\n\n  useEffect(() => {\n    for(let i = 0; i < ICON_NUMBER; i++){\n      let node = createNode(`<div class=\"iconfont\">&#xe642;</div>`);\n      iconsRef.current.appendChild(node);\n    }\n    let domArray = [].slice.call(iconsRef.current.children)\n    domArray.forEach(item => {\n      item.running = false;\n      item.addEventListener('transitionend', function() {\n        this.style['display'] = 'none';\n        this.style[transform] = `translate3d(0, 0, 0)`;\n        this.running = false;\n\n        let icon = this.querySelector('div');\n        icon.style[transform] = `translate3d(0, 0, 0)`;\n      }, false);\n    });\n    // eslint-disable-next-line\n  }, []);\n\n  const startAnimation = ({x, y}) => {\n    for(let i = 0; i < ICON_NUMBER; i++) {\n      let domArray = [].slice.call(iconsRef.current.children)\n      let item = domArray[i]\n      // 选择一个空闲的元素来开始动画\n      if (item.running === false) {\n        item.style.left = x + \"px\";\n        item.style.top = y + \"px\";\n        item.style.display = \"inline-block\";\n        setTimeout(() => {\n          item.running = true;\n          item.style[transform] = `translate3d(0, 750px, 0)`;\n          let icon = item.querySelector(\"div\");\n          icon.style[transform] = `translate3d(-40px, 0, 0)`;\n        }, 20);\n        break;\n      }\n    }\n  };\n  \n  //外界调用的ref方法\n  useImperativeHandle(ref, () => ({\n    startAnimation\n  }));\n\n  return (\n    <Container ref={iconsRef}>\n    </Container>\n  )\n})\n\nexport default React.memo(MusicNote);","import styled from 'styled-components';\nimport style from '../../assets/global-style';\n\nexport const Container = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 1000;\n  background: #fff;\n  transform-origin: right bottom;\n  &.fly-enter, &.fly-appear{\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n  &.fly-enter-active, &.fly-appear-active{\n    transition: transform .3s;\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit{\n    transform: rotateZ(0deg) translate3d(0, 0, 0);\n  }\n  &.fly-exit-active{\n    transition: transform .3s;\n    transform: rotateZ(30deg) translate3d(100%, 0, 0);\n  }\n`;\n\nexport const TopDesc = styled.div`\n  background-size: 100%;\n  padding: 5px 20px;\n  padding-bottom: 50px;\n  margin-bottom: 20px;\n  display: flex;\n  justify-content: space-around;\n  align-items: center;\n  box-sizing: border-box;\n  width: 100%;\n  height: 275px;\n  position: relative;\n  .background{\n    z-index: -1;\n    background: url(${props => props.background}) no-repeat;\n    background-position: 0 0;\n    background-size: 100% 100%;\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    filter: blur(20px);\n    .filter{\n      position: absolute;\n      z-index: 10;\n      top: 0; left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(7, 17, 27, 0.2);\n    }\n  }\n  .img_wrapper{\n    width: 120px;\n    height: 120px;\n    position: relative;         \n    .decorate {\n      position: absolute;\n      top: 0;\n      width: 100%;\n      height: 35px;\n      border-radius: 3px;\n      background: linear-gradient(hsla(0,0%,43%,.4),hsla(0,0%,100%,0));\n    }\n    .play_count {\n      position: absolute;\n      right: 2px;\n      top: 2px;\n      font-size: ${style[\"font-size-s\"]};\n      line-height: 15px;\n      color: ${style[\"font-color-light\"]};\n      .play{\n        vertical-align: top;\n      }\n    }\n    img{\n      width: 120px;\n      height: 120px;\n      border-radius:3px;\n    }\n  }\n  .desc_wrapper {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    justify-content: space-around;\n    height: 120px;\n    padding: 0 10px;\n    .title{\n      max-height: 70px;\n      color: ${style[\"font-color-light\"]};\n      font-weight: 700;\n      line-height: 1.5;\n      font-size: ${style[\"font-size-l\"]};\n    }\n    .person{\n      display: flex;\n      .avatar{\n        width: 20px;\n        height: 20px;\n        margin-right: 5px;\n        img{\n          width: 100%;\n          height: 100%;\n          border-radius: 50%;\n        }\n      }\n      .name {\n        line-height: 20px;\n        font-size: ${style[\"font-size-m\"]};\n        color: ${style[\"font-color-desc-v2\"]};\n      }\n    }\n  }\n`;\n\nexport const Menu = styled.div`\n  position: relative;\n  display: flex;\n  justify-content: space-between;\n  box-sizing: border-box;\n  padding: 0 30px 20px 30px;\n  margin: -100px 0 0 0;\n  >div {\n    display: flex;\n    flex-direction: column;\n    line-height: 20px;\n    text-align: center;\n    font-size: ${style[\"font-size-s\"]};\n    color: #3b1f1f;\n    color: ${style[\"font-color-light\"]};\n    z-index:1000;\n    font-weight: 500;\n    .iconfont {\n      font-size: 20px;\n    }\n  }\n`;\n\nexport const SongList = styled.div`\n  border-radius: 10px;\n  opacity: 0.98;\n  background: ${style[\"highlight-background-color\"]};\n  .first_line{\n    box-sizing: border-box;\n    padding: 10px 0;\n    margin-left: 10px;\n    position: relative;\n    justify-content: space-between;\n    border-bottom: 1px solid ${style[\"border-color\"]};\n    .play_all{\n      display: inline-block;\n      line-height: 24px;\n      color: ${style[\"font-color-desc\"]};\n      .iconfont {\n        font-size: 24px;\n        margin-right: 10px;\n        vertical-align: top;\n      }\n      .sum{\n        font-size: ${style[\"font-size-s\"]};\n        color: ${style[\"font-color-desc-v2\"]};\n      }\n      >span{\n        vertical-align: top;\n      }\n    }\n    .add_list,.isCollected {\n      display: flex;\n      align-items: center;\n      position: absolute;\n      right: 0; top :0px; bottom: 0;\n      width: 130px;\n      line-height: 34px;\n      background: ${style[\"theme-color\"]};\n      color: ${style[\"font-color-light\"]};\n      font-size: 0;\n      border-radius: 3px;\n      vertical-align: top;\n      .iconfont {\n        vertical-align: top;\n        font-size: 10px;\n        margin: 0 5px 0 10px;\n      }\n      span{\n        font-size: 14px;\n        line-height: 34px;\n      }\n    }\n    .isCollected{\n      display: flex;\n      background: ${style[\"background-color\"]};\n      color: ${style[\"font-color-desc\"]};\n    }\n}\n`\nexport const SongItem = styled.ul`\n  >li{\n    display: flex;\n    height: 60px;\n    align-items: center;  \n    .index{\n      flex-basis: 60px;\n      width: 60px;\n      height: 60px;\n      line-height: 60px;\n      text-align: center;\n    }\n    .info{\n      box-sizing: border-box;\n      flex: 1;\n      display: flex;\n      height: 100%;\n      padding: 5px 0;\n      flex-direction: column;\n      justify-content: space-around;\n      border-bottom: 1px solid ${style[\"border-color\"]};\n      ${style.noWrap()}\n      >span{\n        ${style.noWrap()}\n      }\n      >span:first-child{\n        color: ${style[\"font-color-desc\"]};\n      }\n      >span:last-child{\n        font-size: ${style[\"font-size-s\"]};\n        color: #bba8a8;\n      }\n    }\n  }\n`","import React from 'react';\nimport styled from'styled-components';\nimport style from '../../assets/global-style';\nimport PropTypes from \"prop-types\";\n\nconst HeaderContainer = styled.div`\n  position: fixed;\n  padding: 5px 10px;\n  padding-top: 0;\n  height: 40px;\n  width: 100%;\n  z-index: 100;\n  display: flex;\n  line-height: 40px;\n  color: ${style [\"font-color-light\"]};\n  .back {\n    margin-right: 5px;\n    font-size: 20px;\n    width: 20px;\n  }\n  >h1 {\n    font-size: ${style [\"font-size-l\"]};\n    font-weight: 700;\n  }\n`\n// 处理函数组件拿不到 ref 的问题，所以用 forwardRef\nconst Header =  React.forwardRef ((props, ref) => {\n  const { handleClick, title, isMarquee} = props;\n  return (\n    <HeaderContainer ref={ref}>\n      <i className=\"iconfont back\"  onClick={handleClick}>&#xe655;</i>\n      {\n        isMarquee ? <marquee><h1>{title}</h1></marquee>:\n        <h1>{title}</h1>\n      }\n    </HeaderContainer>\n  )\n})\n\nHeader.defaultProps = {\n  handleClick: () => {},\n  title: \"标题\",\n  isMarquee: false\n};\n\nHeader.propTypes = {\n  handleClick: PropTypes.func,\n  title: PropTypes.string,\n  isMarquee: PropTypes.bool\n};\n\nexport default React.memo (Header);","import styled from 'styled-components';\nimport style from '../../assets/global-style';\n\nexport const SongList = styled.div`\n  border-radius: 10px;\n  opacity: 0.98;\n  ${props => props.showBackground ? `background: ${style[\"highlight-background-color\"]}`: \"\"};\n  .first_line{\n    box-sizing: border-box;\n    padding: 10px 0;\n    margin-left: 10px;\n    position: relative;\n    justify-content: space-between;\n    border-bottom: 1px solid ${style[\"border-color\"]};\n    .play_all{\n      display: inline-block;\n      line-height: 24px;\n      color: ${style[\"font-color-desc\"]};\n      .iconfont {\n        font-size: 24px;\n        margin-right: 10px;\n        vertical-align: top;\n      }\n      .sum{\n        font-size: ${style[\"font-size-s\"]};\n        color: ${style[\"font-color-desc-v2\"]};\n      }\n      >span{\n        vertical-align: top;\n      }\n    }\n    .add_list,.isCollected {\n      display: flex;\n      align-items: center;\n      position: absolute;\n      right: 0; top :0; bottom: 0;\n      width: 130px;\n      line-height: 34px;\n      background: ${style[\"theme-color\"]};\n      color: ${style[\"font-color-light\"]};\n      font-size: 0;\n      border-radius: 3px;\n      vertical-align: top;\n      .iconfont {\n        vertical-align: top;\n        font-size: 10px;\n        margin: 0 5px 0 10px;\n      }\n      span{\n        font-size: 14px;\n        line-height: 34px;\n      }\n    }\n    .isCollected{\n      display: flex;\n      background: ${style[\"background-color\"]};\n      color: ${style[\"font-color-desc\"]};\n    }\n}\n`\nexport const SongItem = styled.ul`\n  >li{\n    display: flex;\n    height: 60px;\n    align-items: center;  \n    .index{\n      flex-basis: 60px;\n      width: 60px;\n      height: 60px;\n      line-height: 60px;\n      text-align: center;\n    }\n    .info{\n      box-sizing: border-box;\n      flex: 1;\n      display: flex;\n      height: 100%;\n      padding: 5px 0;\n      flex-direction: column;\n      justify-content: space-around;\n      border-bottom: 1px solid ${style[\"border-color\"]};\n      ${style.noWrap()}\n      >span{\n        ${style.noWrap()}\n      }\n      >span:first-child{\n        color: ${style[\"font-color-desc\"]};\n      }\n      >span:last-child{\n        font-size: ${style[\"font-size-s\"]};\n        color: #bba8a8;\n      }\n    }\n  }\n`","import React, {useState, useEffect } from 'react';\nimport { SongList, SongItem } from \"./style\";\nimport { getName } from '../../api/utils';\nimport { ONE_PAGE_COUNT } from '../../api/config';\nimport { connect } from 'react-redux';\nimport { changePlayList, changeCurrentIndex, changeSequecePlayList } from './../../application/Player/store/actionCreators';\n\nconst SongsList = React.forwardRef((props, refs)=> {\n\n  const [startIndex, setStartIndex] = useState(0);\n\n  const { songs, collectCount, showCollect,loading=false, usePageSplit } = props;\n\n  const { musicAnimation } = props;\n\n  const { changePlayListDispatch, changeCurrentIndexDispatch, changeSequecePlayListDispatch } = props;\n  const totalCount = songs.length;\n\n  useEffect(() => {\n    if(!loading) return;\n    if(startIndex + 1 + ONE_PAGE_COUNT >= totalCount)\n      return;\n    setStartIndex(startIndex + ONE_PAGE_COUNT);\n  }, [loading, startIndex, totalCount]);\n\n  const selectItem = (e, index) => {\n    changePlayListDispatch(songs);\n    changeSequecePlayListDispatch(songs);\n    changeCurrentIndexDispatch(index);\n    musicAnimation(e.nativeEvent.clientX, e.nativeEvent.clientY);\n  }\n\n  let songList = (list) => {\n    let res = [];\n    // 判断页数是否超过总数\n    let end = usePageSplit ? startIndex + ONE_PAGE_COUNT : list.length;\n    for(let i = 0; i < end; i++) {\n      if(i >= list.length) break;\n      let item = list[i];\n      res.push(\n        <li key={item.id} onClick={(e) => selectItem(e, i)}>\n          <span className=\"index\">{i + 1}</span>\n          <div className=\"info\">\n            <span>{item.name}</span>\n            <span>\n              { item.ar ? getName(item.ar): getName(item.artists) } - { item.al ? item.al.name : item.album.name}\n            </span>\n          </div>\n        </li>\n      )\n    }\n    return res;\n  };\n\n  const collect = (count) => {\n    return  (\n      <div className=\"add_list\">\n        <i className=\"iconfont\">&#xe62d;</i>\n        <span>收藏({Math.floor(count/1000)/10}万)</span>\n      </div>\n      // <div className=\"isCollected\">\n      //   <span>已收藏({Math.floor(count/1000)/10}万)</span>\n      // </div>\n    )\n  };\n  return (\n    <SongList ref={refs} showBackground={props.showBackground}>\n      <div className=\"first_line\">\n        <div className=\"play_all\" onClick={(e) => selectItem(e, 0)}>\n          <i className=\"iconfont\">&#xe6e3;</i>\n          <span>播放全部 <span className=\"sum\">(共{totalCount}首)</span></span>\n        </div>\n        { showCollect ? collect(collectCount) : null}\n      </div>\n      <SongItem>\n        { songList(songs) }\n      </SongItem>\n    </SongList>\n  )\n});\n\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = (state) => ({\n  fullScreen: state.getIn(['player', 'fullScreen']),\n  playing: state.getIn(['player', 'playing']),\n  currentSong: state.getIn(['player', 'currentSong']),\n  scrollY: state.getIn(['album', 'scrollY'])  \n});\n// 映射dispatch到props上\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    changePlayListDispatch(data){\n      dispatch(changePlayList(data));\n    },\n    changeCurrentIndexDispatch(data) {\n      dispatch(changeCurrentIndex(data));\n    },\n    changeSequecePlayListDispatch(data) {\n      dispatch(changeSequecePlayList(data))\n    }\n  }\n};\n\n\n// 将ui组件包装成容器组件\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(SongsList));","import React, { useState, useCallback, useRef, useEffect } from 'react';\nimport { Container, TopDesc, Menu } from './style';\nimport { CSSTransition } from 'react-transition-group';\nimport Header from './../../baseUI/header/index';\nimport Scroll from '../../baseUI/scroll/index';\nimport { getCount, isEmptyObject } from '../../api/utils';\nimport { HEADER_HEIGHT } from './../../api/config';\nimport style from \"../../assets/global-style\";\nimport { connect } from 'react-redux';\nimport { getAlbumList, changeEnterLoading } from './store/actionCreators';\nimport Loading from '../../baseUI/loading/index';\nimport SongsList from '../SongsList';\nimport MusicNote from \"../../baseUI/music-note/index\";\n\nfunction Album(props) {\n  const [showStatus, setShowStatus] = useState(true);\n  const [title, setTitle] = useState(\"歌单\");\n  const [isMarquee, setIsMarquee] = useState(false);//是否跑马灯\n\n  const headerEl = useRef();\n  const musicNoteRef = useRef();\n\n  const { currentAlbum: currentAlbumImmutable, enterLoading, songsCount } = props;\n  const { getAlbumDataDispatch } = props;\n\n  const id = props.match.params.id;\n\n  useEffect(() => {\n    getAlbumDataDispatch(id);\n  }, [getAlbumDataDispatch, id]);\n\n  let currentAlbum = currentAlbumImmutable.toJS();\n\n  const handleBack = useCallback(() => {\n    setShowStatus(false);\n  }, []);\n\n  const handleScroll = useCallback((pos) => {\n    let minScrollY = -HEADER_HEIGHT;\n    let percent = Math.abs(pos.y / minScrollY);\n    let headerDom = headerEl.current;\n    //滑过顶部的高度开始变化\n    if (pos.y < minScrollY) {\n      headerDom.style.backgroundColor = style[\"theme-color\"];\n      headerDom.style.opacity = Math.min(1, (percent - 1) / 2);\n      setTitle(currentAlbum.name);\n      setIsMarquee(true);\n    } else {\n      headerDom.style.backgroundColor = \"\";\n      headerDom.style.opacity = 1;\n      setTitle(\"歌单\");\n      setIsMarquee(false);\n    }\n  }, [currentAlbum]);\n\n  const musicAnimation = (x, y) => {\n    musicNoteRef.current.startAnimation({ x, y });\n  };\n  \n  const renderTopDesc = () => {\n    return (\n      <TopDesc background={currentAlbum.coverImgUrl}>\n        <div className=\"background\">\n          <div className=\"filter\"></div>\n        </div>\n        <div className=\"img_wrapper\">\n          <div className=\"decorate\"></div>\n          <img src={currentAlbum.coverImgUrl} alt=\"\" />\n          <div className=\"play_count\">\n            <i className=\"iconfont play\">&#xe885;</i>\n            <span className=\"count\">{getCount(currentAlbum.subscribedCount)}</span>\n          </div>\n        </div>\n        <div className=\"desc_wrapper\">\n          <div className=\"title\">{currentAlbum.name}</div>\n          <div className=\"person\">\n            <div className=\"avatar\">\n              <img src={currentAlbum.creator.avatarUrl} alt=\"\" />\n            </div>\n            <div className=\"name\">{currentAlbum.creator.nickname}</div>\n          </div>\n        </div>\n      </TopDesc>\n    )\n  }\n\n  const renderMenu = () => {\n    return (\n      <Menu>\n        <div>\n          <i className=\"iconfont\">&#xe6ad;</i>\n          评论\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe86f;</i>\n          点赞\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe62d;</i>\n          收藏\n        </div>\n        <div>\n          <i className=\"iconfont\">&#xe606;</i>\n          更多\n        </div>\n      </Menu>\n    )\n  };\n\n  return (\n    <CSSTransition\n      in={showStatus}\n      timeout={300}\n      classNames=\"fly\"\n      appear={true}\n      unmountOnExit\n      onExited={props.history.goBack}\n    >\n      <Container play={songsCount}>\n        <Header ref={headerEl} title={title} handleClick={handleBack} isMarquee={isMarquee}></Header>\n        {!isEmptyObject(currentAlbum) ?\n          (\n            <Scroll\n              bounceTop={false}\n              onScroll={handleScroll}\n            >\n              <div>\n                { renderTopDesc() }\n                { renderMenu() }\n                <SongsList\n                  songs={currentAlbum.tracks}\n                  collectCount={currentAlbum.subscribedCount}\n                  showCollect={true}\n                  showBackground={true}\n                  musicAnimation={musicAnimation}\n                ></SongsList>\n              </div>\n            </Scroll>\n          )\n          : null\n        }\n        { enterLoading ? <Loading></Loading> : null}\n        <MusicNote ref={musicNoteRef}></MusicNote>\n      </Container>\n    </CSSTransition>\n  )\n}\n\n// 映射Redux全局的state到组件的props上\nconst mapStateToProps = (state) => ({\n  currentAlbum: state.getIn(['album', 'currentAlbum']),\n  enterLoading: state.getIn(['album', 'enterLoading']),\n  songsCount: state.getIn(['player', 'playList']).size\n});\n// 映射dispatch到props上\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    getAlbumDataDispatch(id) {\n      dispatch(changeEnterLoading(true));\n      dispatch(getAlbumList(id));\n    },\n  }\n};\n\n// 将ui组件包装成容器组件\nexport default connect(mapStateToProps, mapDispatchToProps)(React.memo(Album));"],"sourceRoot":""}